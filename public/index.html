<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundo Geek - API Tester</title>
    <style>
        :root {
            --primary: #6200ee;
            --secondary: #03dac6;
            --bg: #121212;
            --surface: #1e1e1e;
            --error: #cf6679;
            --text: #e1e1e1;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
        }

        h1 { color: var(--secondary); text-align: center; }

        .card {
            background: var(--surface);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            border: 1px solid #333;
            background: #2c2c2c;
            color: white;
            box-sizing: border-box;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-post { background-color: var(--secondary); color: black; }
        .btn-get { background-color: var(--primary); color: white; }
        button:hover { opacity: 0.8; }

        pre {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 300px;
            font-size: 14px;
            border-left: 4px solid var(--secondary);
        }

        .response-container { margin-top: 10px; }
        .status { font-weight: bold; margin-bottom: 5px; }
        .status.success { color: var(--secondary); }
        .status.error { color: var(--error); }
    </style>
</head>
<body>

<div class="container">
    <h1>ðŸš€ Mundo Geek API Tester</h1>

    <!-- CATEGORIAS -->
    <div class="card">
        <h2>ðŸ“‚ Categorias</h2>
        <div class="grid">
            <div>
                <h3>Criar Categoria</h3>
                <form id="form-categoria">
                    <label>Nome:</label>
                    <input type="text" id="cat-nome" placeholder="Ex: Action Figures" required>
                    <label>DescriÃ§Ã£o:</label>
                    <textarea id="cat-desc" placeholder="Opcional"></textarea>
                    <button type="submit" class="btn-post">Criar Categoria</button>
                </form>
            </div>
            <div>
                <h3>AÃ§Ãµes</h3>
                <button onclick="apiFetch('/categorias', 'GET')" class="btn-get">Listar Tudo</button>
                <div style="margin-top:10px">
                    <input type="number" id="cat-id" placeholder="ID para buscar/deletar" style="width: 100px; margin-bottom:0">
                    <button onclick="buscarCategoria()" class="btn-get">Buscar</button>
                    <button onclick="deletarCategoria()" style="background: var(--error); color: white;">Deletar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- PRODUTOS -->
    <div class="card">
        <h2>ðŸŽ® Produtos</h2>
        <div class="grid">
            <div>
                <h3>Criar Produto</h3>
                <form id="form-produto">
                    <label>Nome:</label>
                    <input type="text" id="prod-nome" required>
                    <label>PreÃ§o:</label>
                    <input type="number" step="0.01" id="prod-preco" required>
                    <label>Estoque:</label>
                    <input type="number" id="prod-estoque" required>
                    <label>ID Categoria:</label>
                    <input type="number" id="prod-catId" required>
                    <label>DescriÃ§Ã£o:</label>
                    <textarea id="prod-desc"></textarea>
                    <button type="submit" class="btn-post">Criar Produto</button>
                </form>
            </div>
            <div>
                <h3>AÃ§Ãµes</h3>
                <button onclick="apiFetch('/produtos', 'GET')" class="btn-get">Listar Tudo</button>
                <div style="margin-top:10px">
                    <input type="number" id="prod-id" placeholder="ID" style="width: 100px; margin-bottom:0">
                    <button onclick="buscarProduto()" class="btn-get">Buscar</button>
                    <button onclick="deletarProduto()" style="background: var(--error); color: white;">Deletar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- RESULTADO -->
    <div class="card">
        <h2>ðŸ’» Resposta da API</h2>
        <div id="output-container" class="response-container">
            <div id="api-status" class="status">Aguardando requisiÃ§Ã£o...</div>
            <pre id="api-result">{}</pre>
        </div>
    </div>
</div>

<script>
    const output = document.getElementById('api-result');
    const statusDiv = document.getElementById('api-status');

    async function apiFetch(endpoint, method, body = null) {
        statusDiv.innerText = 'Carregando...';
        statusDiv.className = 'status';
        
        try {
            const options = {
                method,
                headers: { 'Content-Type': 'application/json' }
            };
            if (body) options.body = JSON.stringify(body);

            const response = await fetch(endpoint, options);
            const data = await response.json();

            statusDiv.innerText = `Status: ${response.status} ${response.statusText}`;
            statusDiv.className = response.ok ? 'status success' : 'status error';
            output.innerText = JSON.stringify(data, null, 2);
        } catch (error) {
            statusDiv.innerText = 'Erro na requisiÃ§Ã£o';
            statusDiv.className = 'status error';
            output.innerText = error.message;
        }
    }

    // Forms
    document.getElementById('form-categoria').onsubmit = (e) => {
        e.preventDefault();
        const nome = document.getElementById('cat-nome').value;
        const descricao = document.getElementById('cat-desc').value;
        apiFetch('/categorias', 'POST', { nome, descricao });
    };

    document.getElementById('form-produto').onsubmit = (e) => {
        e.preventDefault();
        apiFetch('/produtos', 'POST', {
            nome: document.getElementById('prod-nome').value,
            preco: parseFloat(document.getElementById('prod-preco').value),
            estoque: parseInt(document.getElementById('prod-estoque').value),
            categoriaId: parseInt(document.getElementById('prod-catId').value),
            descricao: document.getElementById('prod-desc').value
        });
    };

    // Aux
    function buscarCategoria() {
        const id = document.getElementById('cat-id').value;
        if(id) apiFetch(`/categorias/${id}`, 'GET');
    }
    function deletarCategoria() {
        const id = document.getElementById('cat-id').value;
        if(id) apiFetch(`/categorias/${id}`, 'DELETE');
    }
    function buscarProduto() {
        const id = document.getElementById('prod-id').value;
        if(id) apiFetch(`/produtos/${id}`, 'GET');
    }
    function deletarProduto() {
        const id = document.getElementById('prod-id').value;
        if(id) apiFetch(`/produtos/${id}`, 'DELETE');
    }
</script>

</body>
</html>
